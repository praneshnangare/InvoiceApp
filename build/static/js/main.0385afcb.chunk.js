(this.webpackJsonpinvoicee=this.webpackJsonpinvoicee||[]).push([[0],{152:function(e,t,r){},157:function(e,t,r){"use strict";r.r(t);var n=r(0),s=r.n(n),a=r(120),o=r.n(a),c=(r(152),r(211)),u=r(62),i=r(11),d=r(35),l=r(12),h=r(7),b=r(221),p=r(101),m=r(217),j=r(226),x=r(218),v=r(213),f=r(219),g=r(212),O=r(222),I=r(13),w=r(19),C="14zYQVENvbZxfaLFHrFjebrI6CEioJGY0lDygr5yXl80",y="Customers!A5:E",V="Products!B5:B",E="Customers!H4",S={style:"SOLID",width:1,color:{red:0,green:0,blue:0}},F={bothVertical:{left:S,right:S},bothHorizontal:{top:S,bottom:S},allSides:{top:S,bottom:S,left:S,right:S},top:{top:S},left:{left:S},right:{right:S},bottom:{bottom:S}},N=function(){var e=Object(w.a)(Object(I.a)().mark((function e(t){var r;return Object(I.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,window.gapi.client.sheets.spreadsheets.create({resource:{properties:{title:t}}});case 2:return r=e.sent,e.abrupt("return",r);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),q=function(){var e=Object(w.a)(Object(I.a)().mark((function e(t,r,n){var s;return Object(I.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,window.gapi.client.sheets.spreadsheets.sheets.copyTo({spreadsheetId:r,sheetId:n,resource:{destinationSpreadsheetId:t}});case 2:return s=e.sent,e.abrupt("return",s);case 4:case"end":return e.stop()}}),e)})));return function(t,r,n){return e.apply(this,arguments)}}(),R=function(){var e=Object(w.a)(Object(I.a)().mark((function e(t,r){var n;return Object(I.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,window.gapi.client.sheets.spreadsheets.batchUpdate({spreadsheetId:t,resource:{requests:r}}).then((function(e){console.log("Batch update successful")})).catch((function(e){console.error("Error performing batch update: ",e)}));case 2:return n=e.sent,e.abrupt("return",n);case 4:case"end":return e.stop()}}),e)})));return function(t,r){return e.apply(this,arguments)}}(),k=function(){var e=Object(w.a)(Object(I.a)().mark((function e(t,r){var n;return Object(I.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n="https://docs.google.com/spreadsheets/d/".concat(t,"/export?exportFormat=pdf&gid=").concat(r),window.open(n,"_blank");case 2:case"end":return e.stop()}}),e)})));return function(t,r){return e.apply(this,arguments)}}(),D=function(e){var t=["Zero","One","Two","Three","Four","Five","Six","Seven","Eight","Nine","Ten","Eleven","Twelve","Thirteen","Fourteen","Fifteen","Sixteen","Seventeen","Eighteen","Nineteen"],r=["","","Twenty","Thirty","Forty","Fifty","Sixty","Seventy","Eighty","Ninety"],n=function(e){var n=Math.floor(e/100),s=e%100,a="";return 0!==n&&(a+=t[n]+" Hundred",0!==s&&(a+=" and ")),0!==s&&(a+=function(e){if(e<20)return t[e];var n=Math.floor(e/10),s=e%10;return r[n]+(0!==s?" "+t[s]:"")}(s)),a};if(0===e)return t[e];for(var s=[];e>0;)s.push(e%1e3),e=Math.floor(e/1e3);for(var a=[""," Thousand"," Lakh"," Crore"],o="",c=s.length-1;c>=0;c--){var u=s[c];if(0!==u)o+=n(u)+a[c]+" "}return o.trim()},B=function(e,t){var r=0;e.products.map((function(e){r+=Number(e.quantity)*Number(e.price)}));var n=(.09*r).toFixed(2),s=r+2*n,a=Math.round(s).toFixed(2),o=(a-s).toFixed(2),c=D(a),u=(e.products.map((function(e,t){var r;return[t+1,e.name,null!==(r=e.hsn)&&void 0!==r?r:"NA",e.quantity,e.price,e.quantity*e.price]})),e.products.map((function(e,r){var n,s=14+r;return{updateCells:{range:{sheetId:t,startRowIndex:s,endRowIndex:s+1,startColumnIndex:1,endColumnIndex:10},fields:"*",rows:[{values:[{userEnteredValue:{stringValue:String(r+1)},userEnteredFormat:{borders:F.bothVertical}},{userEnteredValue:{stringValue:e.name},userEnteredFormat:{borders:F.bothVertical}},{},{},{},{userEnteredValue:{stringValue:null!==(n=e.hsn)&&void 0!==n?n:"NA"},userEnteredFormat:{borders:F.bothVertical}},{userEnteredValue:{stringValue:e.quantity},userEnteredFormat:{borders:F.bothVertical}},{userEnteredValue:{stringValue:e.price},userEnteredFormat:{borders:F.bothVertical}},{userEnteredValue:{numberValue:e.quantity*e.price},userEnteredFormat:{borders:F.bothVertical}}]}]}}})));return[{updateCells:{range:{sheetId:t,startRowIndex:8,endRowIndex:9,startColumnIndex:1,endColumnIndex:2},fields:"*",rows:[{values:[{userEnteredValue:{stringValue:e.customerName},userEnteredFormat:{borders:F.left}}]}]}},{updateCells:{range:{sheetId:t,startRowIndex:9,endRowIndex:10,startColumnIndex:1,endColumnIndex:2},fields:"*",rows:[{values:[{userEnteredValue:{stringValue:e.customerAddress},userEnteredFormat:{borders:F.left}}]}]}},{updateCells:{range:{sheetId:t,startRowIndex:11,endRowIndex:12,startColumnIndex:2,endColumnIndex:3},fields:"*",rows:[{values:[{userEnteredValue:{stringValue:e.customerGst}}]}]}},{updateCells:{range:{sheetId:t,startRowIndex:12,endRowIndex:13,startColumnIndex:2,endColumnIndex:3},fields:"*",rows:[{values:[{userEnteredValue:{stringValue:e.customerState},userEnteredFormat:{borders:F.bottom}}]}]}},{updateCells:{range:{sheetId:t,startRowIndex:7,endRowIndex:8,startColumnIndex:7,endColumnIndex:8},fields:"*",rows:[{values:[{userEnteredValue:{stringValue:String(e.invoiceNumber)},userEnteredFormat:{borders:F.top}}]}]}},{updateCells:{range:{sheetId:t,startRowIndex:8,endRowIndex:9,startColumnIndex:7,endColumnIndex:8},fields:"*",rows:[{values:[{userEnteredValue:{stringValue:e.invoiceDate}}]}]}},{updateCells:{range:{sheetId:t,startRowIndex:24,endRowIndex:25,startColumnIndex:9,endColumnIndex:10},fields:"*",rows:[{values:[{userEnteredValue:{stringValue:String(r)},userEnteredFormat:{borders:F.bothVertical}}]}]}},{updateCells:{range:{sheetId:t,startRowIndex:25,endRowIndex:26,startColumnIndex:9,endColumnIndex:10},fields:"*",rows:[{values:[{userEnteredValue:{stringValue:String(n)},userEnteredFormat:{borders:F.bothVertical}}]}]}},{updateCells:{range:{sheetId:t,startRowIndex:26,endRowIndex:27,startColumnIndex:9,endColumnIndex:10},fields:"*",rows:[{values:[{userEnteredValue:{stringValue:String(n)},userEnteredFormat:{borders:F.bothVertical}}]}]}},{updateCells:{range:{sheetId:t,startRowIndex:27,endRowIndex:28,startColumnIndex:9,endColumnIndex:10},fields:"*",rows:[{values:[{userEnteredValue:{stringValue:String(o)},userEnteredFormat:{borders:F.bothVertical}}]}]}},{updateCells:{range:{sheetId:t,startRowIndex:28,endRowIndex:29,startColumnIndex:9,endColumnIndex:10},fields:"*",rows:[{values:[{userEnteredValue:{stringValue:String(a)},userEnteredFormat:{borders:F.bothVertical}}]}]}},{updateCells:{range:{sheetId:t,startRowIndex:31,endRowIndex:32,startColumnIndex:1,endColumnIndex:2},fields:"*",rows:[{values:[{userEnteredValue:{stringValue:"INR "+String(c)+" Only"},userEnteredFormat:{borders:Object(d.a)(Object(d.a)({},F.bothHorizontal),F.left)}}]}]}}].concat(Object(l.a)(u))},T=function(){var e,t=Object(i.o)();Object(n.useEffect)((function(){window.gapi.client||t("/")}));var r=function(){var e=Object(w.a)(Object(I.a)().mark((function e(t){var r,n;return Object(I.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=y,a(t),e.next=4,window.gapi.client.sheets.spreadsheets.values.update({copySpreadsheetId:copySpreadsheetId,range:r,valueInputOption:"USER_ENTERED",resource:{values:values}});case 4:n=e.sent,console.log(n),console.log("".concat(n.result.updatedCells," cells updated."));case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),s=function(){var e=Object(w.a)(Object(I.a)().mark((function e(t){return Object(I.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:a(t);case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),a=function(){var t=Object(w.a)(Object(I.a)().mark((function t(r){var n,s,a;return Object(I.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,N("New sheet");case 2:return n=t.sent,e=n.result.spreadsheetId,t.next=6,q(e,C,"1653630901");case 6:return s=t.sent,a=B(r,s.result.sheetId),t.next=10,R(e,a);case 10:return t.sent,k(e,s.result.sheetId),t.abrupt("return",n);case 13:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}();return{updateSheet:r,fetchCustomers:function(e){window.gapi.client.sheets.spreadsheets.values.get({spreadsheetId:C,range:y}).then((function(t){var r=t.result.values.map((function(e){return{id:e[0],name:e[1],address:e[2],gstNumber:e[3],state:e[4]}}));e(r)})).catch((function(e){console.log("Error retrieving spreadsheet values:",e)}))},fetchProducts:function(e){window.gapi.client.sheets.spreadsheets.values.get({spreadsheetId:C,range:V}).then((function(t){var r=t.result.values.map((function(e){return{label:e[0]}}));e(r)})).catch((function(e){console.log("Error retrieving spreadsheet values:",e)}))},fetchInvoiceNumber:function(e){window.gapi.client.sheets.spreadsheets.values.get({spreadsheetId:C,range:E}).then((function(t){var r=t.result.values[0][0];e(Number(r)+1)})).catch((function(e){console.log("Error retrieving spreadsheet values:",e)}))},createInvoice:s}},A=r(5),P=r(220),L=r(223),M=r(215),z=r(202),G=function(){var e=Object(i.o)(),t=Object(n.useState)(!1),r=Object(h.a)(t,2),s=(r[0],r[1]),a=function(){var t=Object(w.a)(Object(I.a)().mark((function t(){return Object(I.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return console.log("logging in"),t.next=3,window.gapi.load("client",Object(w.a)(Object(I.a)().mark((function t(){var r;return Object(I.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,window.gapi.client.init({apiKey:"AIzaSyASjytXBD7oy-7P-6h4vS37rTyOIFEtMTo",clientId:"106800480963-2brh49tiunu5shtuac8u3ojavj96qjcq.apps.googleusercontent.com",discoveryDocs:["https://sheets.googleapis.com/$discovery/rest?version=v4"],scope:"https://www.googleapis.com/auth/spreadsheets",plugin_name:"invoicee"});case 3:return t.next=5,window.gapi.auth2.getAuthInstance().isSignedIn.get();case 5:if(t.sent){t.next=13;break}return t.next=9,window.gapi.auth2.getAuthInstance().signIn();case 9:r=t.sent,console.log(r),t.next=14;break;case 13:s(!0);case 14:e("/create-invoice"),t.next=20;break;case 17:t.prev=17,t.t0=t.catch(0),console.error("Error updating Google Sheet:",t.t0);case 20:case"end":return t.stop()}}),t,null,[[0,17]])}))));case 3:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}();return{login:a,logout:function(){window.gapi.auth2.getAuthInstance().signOut().then((function(){console.log("User signed out."),e("/")}))},user:{}}},H=r(2),Q=Object(A.a)(u.a)((function(e){e.theme;return{textDecoration:"none",textTransform:"none"}})),J=function(){var e=G().logout;return Object(H.jsx)(L.a,{children:[{label:"Create Invoice",value:"/create-invoice"},{label:"View Invoices",value:"/view-invoices"},{label:"Logout",value:"logout",isAction:!0}].map((function(t,r){return Object(H.jsx)(Q,{to:t.value,children:Object(H.jsx)(M.a,{disablePadding:!0,onClick:t.isAction?e:null,children:Object(H.jsx)(z.a,{children:Object(H.jsx)(p.a,{variant:"h6",color:"common.white",children:t.label})})})},r)}))})},U=Object(A.a)(P.a)((function(e){e.theme;return{background:"linear-gradient(180deg, #005C97 19.46%, #363795 122.95%)",borderRadius:"20px",padding:"30px 0px"}})),_=function(){return Object(H.jsx)(U,{elevation:1,children:Object(H.jsx)(J,{})})},X=r(48),Y=r(204),Z=r(224),K=function(e){var t=e.rightComponent,r=Object(X.a)(),n=Object(Y.a)(r.breakpoints.up("md"));return Object(H.jsx)(Z.a,{display:"flex",justifyContent:"center",alignItems:"center",height:"100vh",width:"100vw",children:Object(H.jsx)(Z.a,{style:{flex:1},children:Object(H.jsxs)(b.a,{container:!0,sx:{mt:{xs:-5,md:-12},flex:1},children:[n&&Object(H.jsx)(b.a,{item:!0,md:4,xl:3,sx:{pl:5,pr:5},children:Object(H.jsx)(_,{})}),Object(H.jsx)(b.a,{item:!0,xs:12,md:8,xl:9,sx:{pr:{xs:2,md:5},ml:{xs:2,md:0}},children:Object(H.jsx)(b.a,{item:!0,container:!0,xs:12,children:t?Object(H.jsx)(b.a,{item:!0,xs:12,children:t}):Object(H.jsx)(b.a,{item:!0,xs:12,sx:{pb:4},children:" "})})})]})})})},W=r(128),$=r.n(W),ee=r(127),te=r.n(ee),re=r(129),ne=r(36),se=ne.d().shape({invoiceDate:ne.b().required("Invoice Date is required"),invoiceNumber:ne.e().required("Invoice Number is required"),selectedCustomer:ne.d().shape({name:ne.e().required("Customer Name is required"),address:ne.e().required("Customer Address is required"),gstNumber:ne.e().required("Customer GST Number is required"),state:ne.e().required("Customer State is required")}),products:ne.a().of(ne.d().shape({name:ne.e().required("Product Name is required"),quantity:ne.c().required("Quantity is required").positive("Quantity must be a positive number"),price:ne.c().required("Price is required").positive("Price must be a positive number")})).min(1,"At least one product is required")}),ae=function(){var e,t=Object(n.useState)([]),r=Object(h.a)(t,2),s=r[0],a=r[1],o=Object(n.useState)([]),c=Object(h.a)(o,2),u=c[0],i=c[1],I=T(),w=(I.updateSheet,I.fetchCustomers),C=I.fetchProducts,y=I.fetchInvoiceNumber,V=I.createInvoice;Object(n.useEffect)((function(){w((function(e){return a(e)})),C((function(e){return i(e)})),y((function(e){return E.setFieldValue("invoiceNumber",e)}))}),[]);var E=Object(re.a)({initialValues:{invoiceDate:"",invoiceNumber:0,selectedCustomer:null,products:[{name:"",quantity:0,price:0}]},onSubmit:function(e){var t={invoiceNumber:e.invoiceNumber,invoiceDate:e.invoiceDate,customerName:e.selectedCustomer.name,customerAddress:e.selectedCustomer.address,customerGst:e.selectedCustomer.gstNumber,customerState:e.selectedCustomer.state,products:e.products};V(t)},validationSchema:se}),S=function(e,t,r){var n=Object(l.a)(E.values.products);n[e][t]=r,E.setFieldValue("products",n)},F=function(e){var t;return null!==(t=null===e||void 0===e?void 0:e.label)&&void 0!==t?t:""},N=Object(H.jsx)("form",{onSubmit:E.handleSubmit,children:Object(H.jsxs)(b.a,{item:!0,container:!0,flexDirection:"column",spacing:2,xs:5,children:[Object(H.jsx)(b.a,{item:!0,xs:12,children:Object(H.jsx)(p.a,{variant:"h6",children:"Pranesh Enterprises"})}),Object(H.jsx)(b.a,{item:!0,xs:12,children:Object(H.jsx)(p.a,{variant:"h6",children:"Invoice"})}),Object(H.jsxs)(b.a,{item:!0,xs:12,children:[Object(H.jsx)(m.a,{id:"invoiceDate",label:"Invoice Date",type:"date",value:E.values.invoiceDate,onChange:E.handleChange,onBlur:E.handleBlur,InputLabelProps:{shrink:!0}}),E.touched.invoiceDate&&E.errors.invoiceDate&&Object(H.jsx)(p.a,{color:"error",children:E.errors.invoiceDate})]}),Object(H.jsxs)(b.a,{item:!0,xs:12,children:[Object(H.jsx)(m.a,{id:"invoiceNumber",label:"Invoice Number",value:E.values.invoiceNumber,onChange:E.handleChange,onBlur:E.handleBlur}),E.touched.invoiceNumber&&E.errors.invoiceNumber&&Object(H.jsx)(p.a,{color:"error",children:E.errors.invoiceNumber})]}),Object(H.jsx)(b.a,{item:!0,xs:12,children:Object(H.jsxs)(j.a,{sx:{minWidth:200},children:[Object(H.jsx)(x.a,{id:"customer-name-label",children:"Customer Name"}),Object(H.jsx)(v.a,{labelId:"customer-name-label",id:"customer-name",value:null!==(e=E.values.selectedCustomer)&&void 0!==e?e:"",onChange:function(e){E.setFieldValue("selectedCustomer",e.target.value)},onBlur:E.handleBlur,children:s.map((function(e){return Object(H.jsx)(f.a,{value:e,children:e.name},e.id)}))}),E.touched.selectedCustomer&&E.errors.selectedCustomer&&Object(H.jsx)(p.a,{color:"error",children:E.errors.selectedCustomer.name})]})}),E.values.products.map((function(e,t){return Object(H.jsxs)(b.a,{item:!0,container:!0,spacing:2,flexDirection:"row",children:[Object(H.jsxs)(b.a,{item:!0,xs:5,children:[Object(H.jsx)(g.a,{id:"product-name-".concat(t),options:u,freeSolo:!0,getOptionLabel:F,onInputChange:function(e,r){S(t,"name",r||"")},renderInput:function(r){return Object(H.jsx)(m.a,Object(d.a)(Object(d.a)({},r),{},{label:"Product Name",value:e.name,onChange:function(e){return S(t,"name",e.target.value)},onBlur:E.handleBlur}))}}),E.touched.products&&E.errors.products&&E.errors.products[t]&&Object(H.jsx)(p.a,{color:"error",children:E.errors.products[t].name})]}),Object(H.jsxs)(b.a,{item:!0,xs:3,children:[Object(H.jsx)(m.a,{id:"quantity-".concat(t),label:"Quantity",type:"number",value:e.quantity,onChange:function(e){return S(t,"quantity",e.target.value)},onBlur:E.handleBlur}),E.touched.products&&E.errors.products&&E.errors.products[t]&&Object(H.jsx)(p.a,{color:"error",children:E.errors.products[t].quantity})]}),Object(H.jsxs)(b.a,{item:!0,xs:3,children:[Object(H.jsx)(m.a,{id:"price-".concat(t),label:"Price",type:"number",value:e.price,onChange:function(e){return S(t,"price",e.target.value)},onBlur:E.handleBlur}),E.touched.products&&E.errors.products&&E.errors.products[t]&&Object(H.jsx)(p.a,{color:"error",children:E.errors.products[t].price})]}),Object(H.jsx)(b.a,{item:!0,xs:1,display:"flex",alignItems:"center",children:Object(H.jsx)(te.a,{onClick:function(e){return function(e){var t=Object(l.a)(E.values.products);t.splice(e,1),E.setFieldValue("products",t)}(t)},xs:1})})]},t)})),Object(H.jsx)(b.a,{item:!0,xs:12,display:"flex",alignItems:"center",justifyContent:"center",children:Object(H.jsx)($.a,{onClick:function(){E.setFieldValue("products",[].concat(Object(l.a)(E.values.products),[{name:"",quantity:0,price:0}]))}})}),Object(H.jsx)(b.a,{item:!0,xs:12,display:"flex",marginTop:2,alignItems:"center",justifyContent:"center",children:Object(H.jsx)(O.a,{type:"submit",variant:"contained",color:"success",children:"Submit"})})]})});return Object(H.jsx)(H.Fragment,{children:Object(H.jsx)(K,{rightComponent:N})})},oe=function(){var e=Object(n.useState)(!1),t=Object(h.a)(e,2),r=(t[0],t[1],G().login);return Object(H.jsx)(Z.a,{sx:{display:"flex",width:"100%",height:"100%",justifyContent:"center",alignItems:"center"},children:Object(H.jsx)(O.a,{variant:"contained",color:"success",size:"large",onClick:function(){return r()},children:"Login"})})},ce=function(){return Object(H.jsxs)(H.Fragment,{children:[Object(H.jsx)(i.a,{path:"/",element:Object(H.jsx)(oe,{})}),Object(H.jsx)(i.a,{path:"/create-invoice",element:Object(H.jsx)(ae,{})})]})},ue=function(){var e=Object(u.b)(Object(i.j)(ce()),{basename:""});return Object(H.jsxs)(H.Fragment,{children:[Object(H.jsx)(c.a,{}),Object(H.jsx)(i.c,{router:e})]})};o.a.createRoot(document.getElementById("root")).render(Object(H.jsx)(s.a.StrictMode,{children:Object(H.jsx)(ue,{})}))}},[[157,1,2]]]);
//# sourceMappingURL=main.0385afcb.chunk.js.map